const _0x4fb7b3=_0x2721;function _0x1796(){const _0x28e5d7=['fas','menapiState','category','roleId','message','role-select-dropdown','Вы\x20действительно\x20хотите\x20удалить\x20этот\x20диалог?','Enter','dialogueId','find','parts','<br>','addEventListener','block','stringify','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Печатает...','344401eOCSfn','action','Произошла\x20ошибка\x20при\x20отправке\x20сообщения\x20или\x20обработке\x20ответа:','span','findIndex','querySelector','&#039;','parse','split',':generateContent?key=','toISOString','2683910sosfQv','2044518Rclwsr','blockReason','message-avatar','https://generativelanguage.googleapis.com/v1beta/models/','clipboard','systemInstruction','replace','<span\x20class=\x22bold-text\x22>$1</span>','writeText','API\x20Response\x20data:','candidates','message-input','textContent','Задавай\x20свои\x20вопросы\x20а\x20я\x20помогу\x20вам\x20на\x20них\x20ответить.','then','toString','probability','map','todayRequests','xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx','<span\x20class=\x22wavy-underline-text\x22>$1</span>','prompt','copied','ai-message','Получен\x20неожиданный\x20ответ\x20от\x20AI.\x20Проверьте\x20консоль\x20браузера.','scrollTop','forEach','json','join','classList','&gt;','Ошибка:\x20Диалог\x20не\x20найден.','<i\x20class=\x22fas\x20fa-check\x22></i>','push','sender','today-requests','2220568ngrnRU','Ты\x20-\x20опытный\x20программист,\x20эксперт\x20в\x20различных\x20языках\x20и\x20технологиях.\x20Твоя\x20задача\x20-\x20предоставлять\x20подробные\x20и\x20точные\x20ответы\x20на\x20вопросы,\x20связанные\x20с\x20кодом,\x20алгоритмами\x20и\x20архитектурой.\x20Все\x20примеры\x20кода\x20должны\x20быть\x20представлены\x20в\x20форматированных\x20блоках,\x20снабженных\x20комментариями\x20для\x20облегчения\x20понимания.\x20Тщательно\x20объясняй\x20сложные\x20концепции\x20программирования,\x20используя\x20аналогии\x20и\x20примеры\x20из\x20реального\x20мира.\x20Учитывай\x20контекст\x20вопроса\x20и\x20уровень\x20подготовки\x20пользователя.\x20ПИШИ\x20ВСЕГДА\x20ПО\x20РУССКИ','thinking','status','Ты\x20-\x20талантливый\x20писатель\x20с\x20богатым\x20воображением\x20и\x20отточенным\x20стилем.\x20Твоя\x20задача\x20-\x20помогать\x20пользователю\x20с\x20созданием\x20захватывающих\x20текстов,\x20разработкой\x20оригинальных\x20сюжетов,\x20написанием\x20трогательных\x20стихов\x20и\x20запоминающихся\x20песен.\x20Используй\x20яркий\x20и\x20выразительный\x20язык,\x20умело\x20играй\x20со\x20словами\x20и\x20создавай\x20неповторимую\x20атмосферу.\x20Предлагай\x20несколько\x20вариантов,\x20раскрывающих\x20разные\x20грани\x20темы.\x20ПИШИ\x20ВСЕГДА\x20ПО\x20РУССКИ','Ты\x20-\x20профессиональный\x20переводчик,\x20владеющий\x20множеством\x20языков\x20и\x20обладающий\x20глубоким\x20пониманием\x20культурных\x20нюансов.\x20Твоя\x20задача\x20-\x20обеспечивать\x20точный\x20и\x20стилистически\x20грамотный\x20перевод\x20предоставленного\x20текста\x20с\x20одного\x20языка\x20на\x20другой.\x20Учитывай\x20контекст\x20и\x20целевую\x20аудиторию,\x20чтобы\x20сохранить\x20смысл\x20и\x20эмоциональную\x20окраску\x20оригинала.\x20При\x20необходимости\x20предлагай\x20несколько\x20вариантов\x20перевода.\x20ПИШИ\x20ВСЕГДА\x20ПО\x20РУССКИ','click','random','add','.dropdown-item','disabled','Вы\x20действительно\x20хотите\x20очистить\x20ВСЕ\x20диалоги?\x20Это\x20действие\x20нельзя\x20отменить.','none','Ошибка\x20при\x20копировании\x20текста:','contains','&amp;','unshift','Не\x20удалось\x20получить\x20ответ\x20от\x20AI.','dialogues','.copy-button','user','promptFeedback','content','10mHmnrg','\x20Причины:\x20','chat-title','splice','message-content','copy-button','active','catch','translator','API\x20response\x20structure\x20unexpected:','div','&lt;','preventDefault','.\x20Проверьте\x20консоль\x20браузера\x20(F12).','shiftKey','closest','appendChild','Удалить\x20диалог','text','DOMContentLoaded','167505BiWstv','Программист','Ошибка:\x20Текущий\x20диалог\x20не\x20найден.','substring','remove','trim','selected-role-name','.code-block','error','chat-list','chat-messages','length','style','2780312svgCJi','Неизвестная\x20ошибка','&quot;','...','target','safetyRatings','fa-trash-alt','delete','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22code-block\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22code-block-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22code-language\x22>','Ваш\x20запрос\x20был\x20заблокирован\x20из-за:\x20','clear-chats-button','coder','currentRoleId','getElementById','keypress','stopPropagation','Новый\x20диалог','Писатель','innerHTML','messages','dataset','writer','model','log','totalRequests','parentNode','2554866yiRoQC','Нет\x20диалогов','empty','AIzaSyDhMSW32l2RocTIuWh6bO4vecvufYVMYTU','currentDialogueId','lastRequestDate','getItem','focus','Стандарт','value','Переводчик','.chat-item','display','createElement','code','name','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22copy-button\x22\x20title=\x22Скопировать\x20код\x22><i\x20class=\x22fas\x20fa-copy\x22></i></button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<pre><code>'];_0x1796=function(){return _0x28e5d7;};return _0x1796();}(function(_0x55bac8,_0x39d509){const _0x97a454=_0x2721,_0x569e0d=_0x55bac8();while(!![]){try{const _0x285da0=-parseInt(_0x97a454(0x263))/0x1+-parseInt(_0x97a454(0x207))/0x2*(-parseInt(_0x97a454(0x21b))/0x3)+-parseInt(_0x97a454(0x1f0))/0x4+parseInt(_0x97a454(0x26e))/0x5+parseInt(_0x97a454(0x242))/0x6+parseInt(_0x97a454(0x26f))/0x7+-parseInt(_0x97a454(0x228))/0x8;if(_0x285da0===_0x39d509)break;else _0x569e0d['push'](_0x569e0d['shift']());}catch(_0xb72889){_0x569e0d['push'](_0x569e0d['shift']());}}}(_0x1796,0x46028));const messageInput=document[_0x4fb7b3(0x235)](_0x4fb7b3(0x27a)),sendButton=document[_0x4fb7b3(0x235)]('send-button'),chatMessagesContainer=document[_0x4fb7b3(0x235)](_0x4fb7b3(0x225)),newChatButton=document[_0x4fb7b3(0x235)]('new-chat-button'),chatList=document[_0x4fb7b3(0x235)](_0x4fb7b3(0x224)),clearChatsButton=document[_0x4fb7b3(0x235)](_0x4fb7b3(0x232)),totalRequestsSpan=document[_0x4fb7b3(0x235)]('total-requests'),todayRequestsSpan=document[_0x4fb7b3(0x235)](_0x4fb7b3(0x1ef)),roleSelect=document['getElementById']('role-select'),roleSelectDropdown=document[_0x4fb7b3(0x235)](_0x4fb7b3(0x258)),selectedRoleNameSpan=document[_0x4fb7b3(0x235)](_0x4fb7b3(0x221)),API_KEY=_0x4fb7b3(0x245),MODEL_NAME='gemini-2.0-flash',API_ENDPOINT=_0x4fb7b3(0x272)+MODEL_NAME+_0x4fb7b3(0x26c)+API_KEY,ROLES=[{'id':'standard','name':_0x4fb7b3(0x24a),'prompt':''},{'id':_0x4fb7b3(0x233),'name':_0x4fb7b3(0x21c),'prompt':_0x4fb7b3(0x1f1)},{'id':_0x4fb7b3(0x23d),'name':_0x4fb7b3(0x239),'prompt':_0x4fb7b3(0x1f4)},{'id':_0x4fb7b3(0x20f),'name':_0x4fb7b3(0x24c),'prompt':_0x4fb7b3(0x1f5)}];let dialogues=[],currentDialogueId=null,totalRequests=0x0,todayRequests=0x0,lastRequestDate=null,currentRoleId=ROLES[0x0]['id'];function generateUUID(){const _0x226c5d=_0x4fb7b3;return _0x226c5d(0x1df)[_0x226c5d(0x275)](/[xy]/g,function(_0x5aa5be){const _0x2cca62=_0x226c5d;var _0x3e76b7=Math[_0x2cca62(0x1f7)]()*0x10|0x0,_0x449349=_0x5aa5be=='x'?_0x3e76b7:_0x3e76b7&0x3|0x8;return _0x449349[_0x2cca62(0x27e)](0x10);});}function saveState(){const _0x52ded4=_0x4fb7b3;localStorage['setItem'](_0x52ded4(0x254),JSON[_0x52ded4(0x261)]({'dialogues':dialogues,'currentDialogueId':currentDialogueId,'totalRequests':totalRequests,'todayRequests':todayRequests,'lastRequestDate':lastRequestDate,'currentRoleId':currentRoleId}));}function loadState(){const _0x169ce7=_0x4fb7b3,_0x419f9d=localStorage[_0x169ce7(0x248)](_0x169ce7(0x254));if(_0x419f9d){const _0x56c6ef=JSON[_0x169ce7(0x26a)](_0x419f9d);dialogues=_0x56c6ef[_0x169ce7(0x202)]||[],totalRequests=_0x56c6ef[_0x169ce7(0x240)]||0x0,todayRequests=_0x56c6ef[_0x169ce7(0x1de)]||0x0,lastRequestDate=_0x56c6ef[_0x169ce7(0x247)]||null,currentRoleId=_0x56c6ef[_0x169ce7(0x234)]||ROLES[0x0]['id'];const _0xbbfb6e=new Date()[_0x169ce7(0x26d)]()[_0x169ce7(0x26b)]('T')[0x0];lastRequestDate!==_0xbbfb6e&&(todayRequests=0x0,lastRequestDate=_0xbbfb6e);const _0x84f956=dialogues[_0x169ce7(0x25c)](_0x293707=>_0x293707['id']===_0x56c6ef[_0x169ce7(0x246)]);dialogues[_0x169ce7(0x226)]===0x0||!_0x84f956?createNewChat(![]):currentDialogueId=_0x56c6ef[_0x169ce7(0x246)];}else createNewChat(![]),currentRoleId=ROLES[0x0]['id'];if(!currentDialogueId||!dialogues['find'](_0x2f8af6=>_0x2f8af6['id']===currentDialogueId)){if(dialogues['length']>0x0)currentDialogueId=dialogues[0x0]['id'];else{createNewChat(!![]);return;}}saveState();}function escapeHTML(_0x3ac816){const _0xc75ed4=_0x4fb7b3;return _0x3ac816['replace'](/&/g,_0xc75ed4(0x1ff))['replace'](/</g,_0xc75ed4(0x212))[_0xc75ed4(0x275)](/>/g,_0xc75ed4(0x1ea))[_0xc75ed4(0x275)](/"/g,_0xc75ed4(0x22a))['replace'](/'/g,_0xc75ed4(0x269));}function formatMessageContent(_0x353fbd){const _0x1a9229=_0x4fb7b3,_0x34b923=/```(\w*)\n([\s\S]*?)```/g,_0x39606e=/\*\*(.*?)\*\*/g,_0x923465=/`(.*?)`/g;let _0x4735b6='',_0x2549ba=0x0;_0x353fbd[_0x1a9229(0x275)](_0x34b923,(_0x233ebd,_0x277dc3,_0x1c4c73,_0x5ca998)=>{const _0x24522b=_0x1a9229;let _0x3a2183=_0x353fbd[_0x24522b(0x21e)](_0x2549ba,_0x5ca998);_0x3a2183=escapeHTML(_0x3a2183),_0x3a2183=_0x3a2183[_0x24522b(0x275)](_0x39606e,_0x24522b(0x276)),_0x3a2183=_0x3a2183[_0x24522b(0x275)](_0x923465,'<span\x20class=\x22wavy-underline-text\x22>$1</span>'),_0x3a2183=_0x3a2183[_0x24522b(0x275)](/\n/g,_0x24522b(0x25e)),_0x4735b6+=_0x3a2183;const _0x2a7d64=_0x277dc3||_0x24522b(0x250),_0x5c7c77=_0x1c4c73['trim']();return _0x4735b6+=_0x24522b(0x230)+escapeHTML(_0x2a7d64)+_0x24522b(0x252)+escapeHTML(_0x5c7c77)+'</code></pre>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x2549ba=_0x5ca998+_0x233ebd['length'],_0x233ebd;});let _0x1158f2=_0x353fbd[_0x1a9229(0x21e)](_0x2549ba);return _0x1158f2=escapeHTML(_0x1158f2),_0x1158f2=_0x1158f2[_0x1a9229(0x275)](_0x39606e,_0x1a9229(0x276)),_0x1158f2=_0x1158f2['replace'](_0x923465,_0x1a9229(0x1e0)),_0x1158f2=_0x1158f2[_0x1a9229(0x275)](/\n/g,_0x1a9229(0x25e)),_0x4735b6+=_0x1158f2,_0x4735b6;}function addMessageToChat(_0x4ec9a5,_0xe4e261,_0x33791d=![]){const _0x3f411d=_0x4fb7b3,_0x71eda7=document[_0x3f411d(0x24f)](_0x3f411d(0x211));_0x71eda7[_0x3f411d(0x1e9)]['add'](_0x3f411d(0x257)),_0x71eda7[_0x3f411d(0x1e9)]['add'](_0xe4e261===_0x3f411d(0x204)?'user-message':_0x3f411d(0x1e3));_0x33791d&&_0x71eda7[_0x3f411d(0x1e9)][_0x3f411d(0x1f8)](_0x3f411d(0x1f2));const _0x410297=document['createElement'](_0x3f411d(0x211));_0x410297[_0x3f411d(0x1e9)][_0x3f411d(0x1f8)](_0x3f411d(0x271)),_0x410297[_0x3f411d(0x27b)]=_0xe4e261===_0x3f411d(0x204)?'Вы':'AI';const _0x2d8089=document[_0x3f411d(0x24f)](_0x3f411d(0x211));_0x2d8089[_0x3f411d(0x1e9)][_0x3f411d(0x1f8)](_0x3f411d(0x20b));_0x33791d?_0x2d8089[_0x3f411d(0x23a)]=_0x4ec9a5:_0xe4e261==='ai'?_0x2d8089['innerHTML']=formatMessageContent(_0x4ec9a5):(_0x2d8089[_0x3f411d(0x27b)]=_0x4ec9a5,_0x2d8089[_0x3f411d(0x23a)]=_0x2d8089[_0x3f411d(0x23a)]['replace'](/\n/g,_0x3f411d(0x25e)));_0x71eda7[_0x3f411d(0x217)](_0x410297),_0x71eda7['appendChild'](_0x2d8089),chatMessagesContainer['appendChild'](_0x71eda7),chatMessagesContainer[_0x3f411d(0x1e5)]=chatMessagesContainer['scrollHeight'];if(_0x33791d)return _0x71eda7;}function removeMessageFromChatElement(_0x47c522){const _0x389190=_0x4fb7b3;_0x47c522&&_0x47c522[_0x389190(0x241)]&&_0x47c522['parentNode']['removeChild'](_0x47c522);}function renderMessages(_0xb9471b){const _0x43907d=_0x4fb7b3;chatMessagesContainer[_0x43907d(0x23a)]='';const _0xc8d5b3=dialogues[_0x43907d(0x25c)](_0x45e36a=>_0x45e36a['id']===_0xb9471b);if(!_0xc8d5b3){addMessageToChat(_0x43907d(0x1eb),'ai');return;}_0xc8d5b3['messages'][_0x43907d(0x226)]===0x0?addMessageToChat(_0x43907d(0x27c),'ai'):_0xc8d5b3['messages'][_0x43907d(0x1e6)](_0x3d948b=>{addMessageToChat(_0x3d948b['text'],_0x3d948b['sender']);});}function renderChatList(){const _0x15ac50=_0x4fb7b3;chatList[_0x15ac50(0x23a)]='';if(dialogues[_0x15ac50(0x226)]===0x0){const _0x285443=document['createElement']('li');_0x285443[_0x15ac50(0x1e9)]['add']('chat-item',_0x15ac50(0x244)),_0x285443[_0x15ac50(0x27b)]=_0x15ac50(0x243),chatList[_0x15ac50(0x217)](_0x285443);return;}dialogues[_0x15ac50(0x1e6)](_0x23cfcc=>{const _0x7237e0=_0x15ac50,_0x6929c1=document[_0x7237e0(0x24f)]('li');_0x6929c1[_0x7237e0(0x1e9)][_0x7237e0(0x1f8)]('chat-item');_0x23cfcc['id']===currentDialogueId&&_0x6929c1[_0x7237e0(0x1e9)]['add']('active');_0x6929c1[_0x7237e0(0x23c)][_0x7237e0(0x25b)]=_0x23cfcc['id'];const _0x40ff8d=document['createElement'](_0x7237e0(0x266));_0x40ff8d['classList'][_0x7237e0(0x1f8)](_0x7237e0(0x209));const _0x11ea6=_0x23cfcc[_0x7237e0(0x23b)]['find'](_0x4a2645=>_0x4a2645[_0x7237e0(0x1ee)]===_0x7237e0(0x204));_0x40ff8d['textContent']=_0x23cfcc['title']||(_0x11ea6?_0x11ea6['text'][_0x7237e0(0x21e)](0x0,0x1e)+(_0x11ea6[_0x7237e0(0x219)][_0x7237e0(0x226)]>0x1e?_0x7237e0(0x22b):''):_0x7237e0(0x238));const _0x2bdc06=document[_0x7237e0(0x24f)]('div');_0x2bdc06[_0x7237e0(0x1e9)][_0x7237e0(0x1f8)]('chat-item-actions');const _0x532e8a=document[_0x7237e0(0x24f)]('i');_0x532e8a['classList']['add'](_0x7237e0(0x253),'fa-trash-alt'),_0x532e8a['title']=_0x7237e0(0x218),_0x532e8a[_0x7237e0(0x23c)][_0x7237e0(0x264)]=_0x7237e0(0x22f),_0x2bdc06[_0x7237e0(0x217)](_0x532e8a),_0x6929c1['appendChild'](_0x40ff8d),_0x6929c1[_0x7237e0(0x217)](_0x2bdc06),chatList[_0x7237e0(0x217)](_0x6929c1);});}function renderRolesDropdown(){const _0x499672=_0x4fb7b3;roleSelectDropdown[_0x499672(0x23a)]='',ROLES['forEach'](_0x1160b9=>{const _0x32cd72=_0x499672,_0xa9fcd3=document['createElement'](_0x32cd72(0x211));_0xa9fcd3['classList'][_0x32cd72(0x1f8)]('dropdown-item'),_0x1160b9['id']===currentRoleId&&_0xa9fcd3[_0x32cd72(0x1e9)]['add'](_0x32cd72(0x20d)),_0xa9fcd3['dataset'][_0x32cd72(0x256)]=_0x1160b9['id'],_0xa9fcd3[_0x32cd72(0x27b)]=_0x1160b9[_0x32cd72(0x251)],roleSelectDropdown[_0x32cd72(0x217)](_0xa9fcd3);}),updateSelectedRoleName();}function updateSelectedRoleName(){const _0x4b4484=_0x4fb7b3,_0x5789ac=ROLES[_0x4b4484(0x25c)](_0x51a77a=>_0x51a77a['id']===currentRoleId);selectedRoleNameSpan[_0x4b4484(0x27b)]=_0x5789ac?_0x5789ac[_0x4b4484(0x251)]:'Неизвестная\x20роль';}function switchRole(_0x2f982e){if(currentRoleId===_0x2f982e)return;currentRoleId=_0x2f982e,saveState(),renderRolesDropdown();}function updateCountersUI(){const _0x2052e6=_0x4fb7b3;totalRequestsSpan[_0x2052e6(0x27b)]=totalRequests,todayRequestsSpan['textContent']=todayRequests;}function createNewChat(_0x474873=!![]){const _0x4337cd=_0x4fb7b3,_0x4de652=generateUUID(),_0x4de4a7={'id':_0x4de652,'title':'','messages':[]};dialogues[_0x4337cd(0x200)](_0x4de4a7),_0x474873&&(currentDialogueId=_0x4de652,saveState(),renderChatList(),renderMessages(currentDialogueId));}function _0x2721(_0x53a612,_0x427d9d){const _0x1796de=_0x1796();return _0x2721=function(_0x2721ab,_0x13bc17){_0x2721ab=_0x2721ab-0x1dc;let _0x3c2ce5=_0x1796de[_0x2721ab];return _0x3c2ce5;},_0x2721(_0x53a612,_0x427d9d);}function switchChat(_0x13276a){if(currentDialogueId===_0x13276a)return;currentDialogueId=_0x13276a,saveState(),renderChatList(),renderMessages(currentDialogueId);}function deleteChat(_0x1e1174){const _0x3f729f=_0x4fb7b3,_0x24dc2f=dialogues[_0x3f729f(0x267)](_0xdd6065=>_0xdd6065['id']===_0x1e1174);if(_0x24dc2f===-0x1)return;dialogues[_0x3f729f(0x20a)](_0x24dc2f,0x1);if(dialogues[_0x3f729f(0x226)]===0x0)createNewChat(!![]);else currentDialogueId===_0x1e1174?(currentDialogueId=dialogues[0x0]['id'],saveState(),renderChatList(),renderMessages(currentDialogueId)):(saveState(),renderChatList());}function clearAllChats(){const _0x4fbc91=_0x4fb7b3;confirm(_0x4fbc91(0x1fb))&&(dialogues=[],createNewChat(!![]),updateCountersUI(),saveState());}async function sendMessage(){const _0x100fbb=_0x4fb7b3,_0x261a4c=messageInput[_0x100fbb(0x24b)][_0x100fbb(0x220)]();if(!_0x261a4c)return;const _0x415981=dialogues[_0x100fbb(0x25c)](_0x1ae5ad=>_0x1ae5ad['id']===currentDialogueId);if(!_0x415981){addMessageToChat(_0x100fbb(0x21d),'ai'),saveState();return;}addMessageToChat(_0x261a4c,_0x100fbb(0x204)),_0x415981[_0x100fbb(0x23b)][_0x100fbb(0x1ed)]({'text':_0x261a4c,'sender':_0x100fbb(0x204)}),messageInput[_0x100fbb(0x24b)]='',messageInput['disabled']=!![],sendButton[_0x100fbb(0x1fa)]=!![];const _0x408177=addMessageToChat(_0x100fbb(0x262),'ai',!![]);try{const _0x198bba=ROLES[_0x100fbb(0x25c)](_0x3ab579=>_0x3ab579['id']===currentRoleId),_0x32271d=_0x198bba?_0x198bba[_0x100fbb(0x1e1)]:'',_0x3dd1a9={'contents':_0x415981[_0x100fbb(0x23b)][_0x100fbb(0x1dd)](_0x11f184=>({'role':_0x11f184[_0x100fbb(0x1ee)]==='user'?_0x100fbb(0x204):_0x100fbb(0x23e),'parts':[{'text':_0x11f184['text']}]}))};_0x32271d&&(_0x3dd1a9[_0x100fbb(0x274)]={'parts':[{'text':_0x32271d}]});const _0x1b4bd9=await fetch(API_ENDPOINT,{'method':'POST','headers':{'Content-Type':'application/json'},'body':JSON[_0x100fbb(0x261)](_0x3dd1a9)});removeMessageFromChatElement(_0x408177);if(!_0x1b4bd9['ok']){const _0x381006=await _0x1b4bd9['json']();console[_0x100fbb(0x223)]('API\x20HTTP\x20Error:',_0x1b4bd9[_0x100fbb(0x1f3)],_0x1b4bd9['statusText'],_0x381006);let _0x422228='HTTP\x20Ошибка\x20API:\x20'+_0x1b4bd9[_0x100fbb(0x1f3)]+'\x20'+_0x1b4bd9['statusText']+'.';_0x381006&&_0x381006[_0x100fbb(0x223)]&&_0x381006[_0x100fbb(0x223)][_0x100fbb(0x257)]&&(_0x422228+='\x20Детали:\x20'+_0x381006[_0x100fbb(0x223)]['message']),addMessageToChat(_0x422228,'ai');}else{const _0xf8cada=await _0x1b4bd9[_0x100fbb(0x1e7)]();console[_0x100fbb(0x23f)](_0x100fbb(0x278),_0xf8cada);let _0x2fecb0=_0x100fbb(0x201);if(_0xf8cada[_0x100fbb(0x279)]&&_0xf8cada[_0x100fbb(0x279)][_0x100fbb(0x226)]>0x0&&_0xf8cada[_0x100fbb(0x279)][0x0][_0x100fbb(0x206)]&&_0xf8cada[_0x100fbb(0x279)][0x0][_0x100fbb(0x206)]['parts']&&_0xf8cada[_0x100fbb(0x279)][0x0][_0x100fbb(0x206)][_0x100fbb(0x25d)][_0x100fbb(0x226)]>0x0&&_0xf8cada[_0x100fbb(0x279)][0x0][_0x100fbb(0x206)][_0x100fbb(0x25d)][0x0][_0x100fbb(0x219)]){_0x2fecb0=_0xf8cada[_0x100fbb(0x279)][0x0][_0x100fbb(0x206)][_0x100fbb(0x25d)][0x0][_0x100fbb(0x219)],addMessageToChat(_0x2fecb0,'ai'),_0x415981['messages'][_0x100fbb(0x1ed)]({'text':_0x2fecb0,'sender':'ai'});!_0x415981['title']&&_0x415981['messages'][_0x100fbb(0x226)]>0x0&&_0x415981[_0x100fbb(0x23b)][0x0][_0x100fbb(0x1ee)]===_0x100fbb(0x204)&&(_0x415981['title']=_0x415981[_0x100fbb(0x23b)][0x0]['text'][_0x100fbb(0x21e)](0x0,0x1e)+(_0x415981[_0x100fbb(0x23b)][0x0]['text'][_0x100fbb(0x226)]>0x1e?_0x100fbb(0x22b):''),renderChatList());totalRequests++;const _0x502391=new Date()['toISOString']()[_0x100fbb(0x26b)]('T')[0x0];lastRequestDate!==_0x502391?(todayRequests=0x1,lastRequestDate=_0x502391):todayRequests++,updateCountersUI();}else{if(_0xf8cada[_0x100fbb(0x205)]&&_0xf8cada[_0x100fbb(0x205)][_0x100fbb(0x270)]){let _0x147379=_0xf8cada[_0x100fbb(0x205)][_0x100fbb(0x270)],_0x56a5b1=_0xf8cada['promptFeedback'][_0x100fbb(0x22d)],_0x42385a=_0x100fbb(0x231)+_0x147379+'.';_0x56a5b1&&_0x56a5b1[_0x100fbb(0x226)]>0x0&&(_0x42385a+=_0x100fbb(0x208)+_0x56a5b1[_0x100fbb(0x1dd)](_0x5e6594=>_0x5e6594[_0x100fbb(0x255)]+'\x20('+_0x5e6594[_0x100fbb(0x1dc)]+')')[_0x100fbb(0x1e8)](',\x20')),addMessageToChat(_0x42385a,'ai');}else{console[_0x100fbb(0x223)](_0x100fbb(0x210),_0xf8cada);let _0x171fbb=_0x100fbb(0x1e4);addMessageToChat(_0x171fbb,'ai');}}}saveState();}catch(_0x3e45eb){console['error'](_0x100fbb(0x265),_0x3e45eb),removeMessageFromChatElement(_0x408177);const _0xc07078='Произошла\x20ошибка:\x20'+(_0x3e45eb[_0x100fbb(0x257)]||_0x100fbb(0x229))+_0x100fbb(0x214);addMessageToChat(_0xc07078,'ai'),saveState();}finally{messageInput['disabled']=![],sendButton[_0x100fbb(0x1fa)]=![],messageInput[_0x100fbb(0x249)](),renderChatList();}}sendButton[_0x4fb7b3(0x25f)](_0x4fb7b3(0x1f6),sendMessage),messageInput[_0x4fb7b3(0x25f)](_0x4fb7b3(0x236),function(_0x32ea06){const _0x2e5dba=_0x4fb7b3;_0x32ea06['key']===_0x2e5dba(0x25a)&&!_0x32ea06[_0x2e5dba(0x215)]&&(_0x32ea06[_0x2e5dba(0x213)](),sendMessage());}),newChatButton['addEventListener'](_0x4fb7b3(0x1f6),()=>{createNewChat(!![]);}),clearChatsButton[_0x4fb7b3(0x25f)]('click',()=>{clearAllChats();}),chatList[_0x4fb7b3(0x25f)](_0x4fb7b3(0x1f6),_0x2ea26c=>{const _0x3060f9=_0x4fb7b3,_0x549351=_0x2ea26c['target'][_0x3060f9(0x216)](_0x3060f9(0x24d));if(!_0x549351||!_0x549351[_0x3060f9(0x23c)]['dialogueId'])return;const _0x2ecfb0=_0x549351[_0x3060f9(0x23c)]['dialogueId'],_0x6d5159=_0x2ea26c['target'];_0x6d5159[_0x3060f9(0x1e9)][_0x3060f9(0x1fe)](_0x3060f9(0x22e))?confirm(_0x3060f9(0x259))&&deleteChat(_0x2ecfb0):switchChat(_0x2ecfb0);}),roleSelect[_0x4fb7b3(0x25f)](_0x4fb7b3(0x1f6),_0x29cc1a=>{const _0x3f176e=_0x4fb7b3;_0x29cc1a[_0x3f176e(0x237)](),roleSelectDropdown['style']['display']=roleSelectDropdown[_0x3f176e(0x227)][_0x3f176e(0x24e)]===_0x3f176e(0x260)?'none':_0x3f176e(0x260);}),roleSelectDropdown[_0x4fb7b3(0x25f)](_0x4fb7b3(0x1f6),_0x5117a6=>{const _0x5412d7=_0x4fb7b3,_0x3c5798=_0x5117a6[_0x5412d7(0x22c)][_0x5412d7(0x216)](_0x5412d7(0x1f9));_0x3c5798&&_0x3c5798[_0x5412d7(0x23c)][_0x5412d7(0x256)]&&(switchRole(_0x3c5798[_0x5412d7(0x23c)]['roleId']),roleSelectDropdown['style'][_0x5412d7(0x24e)]=_0x5412d7(0x1fc));}),document[_0x4fb7b3(0x25f)]('click',_0x315f91=>{const _0x6c64c8=_0x4fb7b3;!roleSelect[_0x6c64c8(0x1fe)](_0x315f91[_0x6c64c8(0x22c)])&&(roleSelectDropdown[_0x6c64c8(0x227)][_0x6c64c8(0x24e)]='none');}),chatMessagesContainer[_0x4fb7b3(0x25f)](_0x4fb7b3(0x1f6),_0xa03c88=>{const _0x2e7769=_0x4fb7b3;if(_0xa03c88[_0x2e7769(0x22c)]['classList'][_0x2e7769(0x1fe)](_0x2e7769(0x20c))||_0xa03c88[_0x2e7769(0x22c)][_0x2e7769(0x216)](_0x2e7769(0x203))){const _0x5ab73c=_0xa03c88['target'][_0x2e7769(0x216)](_0x2e7769(0x203)),_0x8b9ef9=_0x5ab73c[_0x2e7769(0x216)](_0x2e7769(0x222));if(_0x8b9ef9){const _0x344afc=_0x8b9ef9[_0x2e7769(0x268)](_0x2e7769(0x250));_0x344afc&&navigator[_0x2e7769(0x273)][_0x2e7769(0x277)](_0x344afc['textContent'])[_0x2e7769(0x27d)](()=>{const _0xa4d137=_0x2e7769,_0x492961=_0x5ab73c[_0xa4d137(0x23a)];_0x5ab73c['innerHTML']=_0xa4d137(0x1ec),_0x5ab73c[_0xa4d137(0x1e9)][_0xa4d137(0x1f8)](_0xa4d137(0x1e2)),setTimeout(()=>{const _0xc28351=_0xa4d137;_0x5ab73c[_0xc28351(0x23a)]=_0x492961,_0x5ab73c['classList'][_0xc28351(0x21f)](_0xc28351(0x1e2));},0x7d0);})[_0x2e7769(0x20e)](_0x466ac7=>{const _0x3d7e21=_0x2e7769;console[_0x3d7e21(0x223)](_0x3d7e21(0x1fd),_0x466ac7);});}}}),document['addEventListener'](_0x4fb7b3(0x21a),()=>{const _0x14ac7c=_0x4fb7b3;loadState(),renderChatList(),currentDialogueId?renderMessages(currentDialogueId):dialogues[_0x14ac7c(0x226)]>0x0?switchChat(dialogues[0x0]['id']):createNewChat(!![]),renderRolesDropdown(),updateCountersUI();});