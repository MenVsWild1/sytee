const _0x1d0733=_0x38d8;(function(_0x134059,_0x1422c0){const _0x5233f2=_0x38d8,_0x343034=_0x134059();while(!![]){try{const _0x13aa2=-parseInt(_0x5233f2(0x107))/0x1*(-parseInt(_0x5233f2(0xf7))/0x2)+-parseInt(_0x5233f2(0x122))/0x3*(-parseInt(_0x5233f2(0xfe))/0x4)+parseInt(_0x5233f2(0x12d))/0x5*(parseInt(_0x5233f2(0x120))/0x6)+-parseInt(_0x5233f2(0x132))/0x7*(parseInt(_0x5233f2(0x195))/0x8)+parseInt(_0x5233f2(0x192))/0x9*(parseInt(_0x5233f2(0x138))/0xa)+parseInt(_0x5233f2(0x157))/0xb+parseInt(_0x5233f2(0x173))/0xc*(-parseInt(_0x5233f2(0x184))/0xd);if(_0x13aa2===_0x1422c0)break;else _0x343034['push'](_0x343034['shift']());}catch(_0x1b7a28){_0x343034['push'](_0x343034['shift']());}}}(_0x4eeb,0x9f65b));const messageInput=document[_0x1d0733(0x142)](_0x1d0733(0x165)),sendButton=document[_0x1d0733(0x142)]('send-button'),chatMessagesContainer=document[_0x1d0733(0x142)]('chat-messages'),newChatButton=document[_0x1d0733(0x142)](_0x1d0733(0x11a)),chatList=document[_0x1d0733(0x142)](_0x1d0733(0x170)),clearChatsButton=document['getElementById'](_0x1d0733(0x10e)),totalRequestsSpan=document[_0x1d0733(0x142)]('total-requests'),todayRequestsSpan=document[_0x1d0733(0x142)](_0x1d0733(0xf9)),roleSelect=document[_0x1d0733(0x142)](_0x1d0733(0x14c)),roleSelectDropdown=document['getElementById'](_0x1d0733(0x146)),selectedRoleNameSpan=document[_0x1d0733(0x142)]('selected-role-name'),burgerButton=document[_0x1d0733(0x142)](_0x1d0733(0x124)),mobileBurgerButton=document[_0x1d0733(0x142)](_0x1d0733(0x178)),sidebar=document[_0x1d0733(0x14d)](_0x1d0733(0x18d)),overlay=document[_0x1d0733(0x15f)]('div');overlay[_0x1d0733(0x190)][_0x1d0733(0x119)](_0x1d0733(0x19c)),document['body'][_0x1d0733(0x11f)](overlay);const API_KEY='AIzaSyDhMSW32l2RocTIuWh6bO4vecvufYVMYTU',MODEL_NAME=_0x1d0733(0x189),API_ENDPOINT='https://generativelanguage.googleapis.com/v1beta/models/'+MODEL_NAME+_0x1d0733(0x14f)+API_KEY,ROLES=[{'id':'standard','name':_0x1d0733(0x182),'prompt':''},{'id':_0x1d0733(0x16a),'name':_0x1d0733(0x14b),'prompt':_0x1d0733(0x16d)},{'id':_0x1d0733(0x11e),'name':_0x1d0733(0x10b),'prompt':_0x1d0733(0x18c)},{'id':_0x1d0733(0x156),'name':_0x1d0733(0x14a),'prompt':_0x1d0733(0x163)}];let dialogues=[],currentDialogueId=null,totalRequests=0x0,todayRequests=0x0,lastRequestDate=null,currentRoleId=ROLES[0x0]['id'];function generateUUID(){const _0x1f6be3=_0x1d0733;return _0x1f6be3(0x12f)[_0x1f6be3(0x179)](/[xy]/g,function(_0x5ed55d){const _0x1e07cd=_0x1f6be3;var _0x5af43e=Math[_0x1e07cd(0x15c)]()*0x10|0x0,_0x131764=_0x5ed55d=='x'?_0x5af43e:_0x5af43e&0x3|0x8;return _0x131764[_0x1e07cd(0x13f)](0x10);});}function saveState(){const _0x324fbf=_0x1d0733;localStorage[_0x324fbf(0x188)]('menapiState',JSON['stringify']({'dialogues':dialogues,'currentDialogueId':currentDialogueId,'totalRequests':totalRequests,'todayRequests':todayRequests,'lastRequestDate':lastRequestDate,'currentRoleId':currentRoleId}));}function _0x4eeb(){const _0x1a19fb=['dropdown-item','2217470aqSeLW','Ошибка:\x20Диалог\x20не\x20найден.','chat-item-actions','click','\x20Детали:\x20','safetyRatings','error','toString','shiftKey','Enter','getElementById','scrollTop','span','length','role-select-dropdown','then','parts','innerHTML','Переводчик','Программист','role-select','querySelector','delete',':generateContent?key=','promptFeedback','&amp;','Новый\x20диалог','messages','name','Неизвестная\x20ошибка','translator','867977pKRXJY','status','stopPropagation','block','splice','random','div','menapiState','createElement','Удалить\x20диалог','Ошибка\x20при\x20копировании\x20текста:','empty','Ты\x20-\x20профессиональный\x20переводчик,\x20владеющий\x20множеством\x20языков\x20и\x20обладающий\x20глубоким\x20пониманием\x20культурных\x20нюансов.\x20Твоя\x20задача\x20-\x20обеспечивать\x20точный\x20и\x20стилистически\x20грамотный\x20перевод\x20предоставленного\x20текста\x20с\x20одного\x20языка\x20на\x20другой.\x20Учитывай\x20контекст\x20и\x20целевую\x20аудиторию,\x20чтобы\x20сохранить\x20смысл\x20и\x20эмоциональную\x20окраску\x20оригинала.\x20При\x20необходимости\x20предлагай\x20несколько\x20вариантов\x20перевода.\x20ПИШИ\x20ВСЕГДА\x20ПО\x20РУССКИ','value','message-input','text','thinking','fa-trash-alt','model','coder','content','active','Ты\x20-\x20опытный\x20программист,\x20эксперт\x20в\x20различных\x20языках\x20и\x20технологиях.\x20Твоя\x20задача\x20-\x20предоставлять\x20подробные\x20и\x20точные\x20ответы\x20на\x20вопросы,\x20связанные\x20с\x20кодом,\x20алгоритмами\x20и\x20архитектурой.\x20Все\x20примеры\x20кода\x20должны\x20быть\x20представлены\x20в\x20форматированных\x20блоках,\x20снабженных\x20комментариями\x20для\x20облегчения\x20понимания.\x20Тщательно\x20объясняй\x20сложные\x20концепции\x20программирования,\x20используя\x20аналогии\x20и\x20примеры\x20из\x20реального\x20мира.\x20ПИШИ\x20ВСЕГДА\x20ПО\x20РУССКИ','sender','writeText','chat-list','<span\x20class=\x22bold-text\x22>$1</span>','probability','25008WXCerZ','preventDefault','keypress','copy-button','disabled','mobile-burger-button','replace','title','message','none','copied','dataset','API\x20Response\x20data:','message-avatar','stringify','Стандарт','contains','7371KcGbLM','parentNode','systemInstruction','target','setItem','gemini-2.0-flash','currentDialogueId','action','Ты\x20-\x20талантливый\x20писатель\x20с\x20богатым\x20воображением\x20и\x20отточенным\x20стилем.\x20Твоя\x20задача\x20-\x20помогать\x20пользователю\x20с\x20созданием\x20захватывающих\x20текстов,\x20разработкой\x20оригинальных\x20сюжетов,\x20написанием\x20трогательных\x20стихов\x20и\x20запоминающихся\x20песен.\x20Используй\x20яркий\x20и\x20выразительный\x20язык,\x20умело\x20играй\x20со\x20словами\x20и\x20создавай\x20неповторимую\x20атмосферу.\x20Предлагай\x20несколько\x20вариантов,\x20раскрывающих\x20разные\x20грани\x20темы.\x20ПИШИ\x20ВСЕГДА\x20ПО\x20РУССКИ','.sidebar','user','textContent','classList','...','27eRKyjm','clipboard','chat-item','485048MRokQI','POST','key','dialogueId','Получен\x20неожиданный\x20ответ\x20от\x20AI.\x20Проверьте\x20консоль\x20браузера.','candidates','Вы\x20действительно\x20хотите\x20удалить\x20этот\x20диалог?','overlay','addEventListener','<i\x20class=\x22fas\x20fa-check\x22></i>','forEach','571498XqHpSB','display','today-requests','&lt;','parse','Не\x20удалось\x20получить\x20ответ\x20от\x20AI.','removeChild','1068dsAwoW','join','Произошла\x20ошибка:\x20','API\x20HTTP\x20Error:','find','totalRequests','substring','toISOString','prompt','2VTznQH','style','</code></pre>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ai-message','Писатель','json','toggle','clear-chats-button','code','Вы\x20действительно\x20хотите\x20очистить\x20ВСЕ\x20диалоги?\x20Это\x20действие\x20нельзя\x20отменить.','map','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22copy-button\x22\x20title=\x22Скопировать\x20код\x22><i\x20class=\x22fas\x20fa-copy\x22></i></button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<pre><code>','fas','DOMContentLoaded','blockReason','&quot;','<i\x20class=\x22fas\x20fa-spinner\x20fa-spin\x22></i>\x20Печатает...','push','add','new-chat-button','Ваш\x20запрос\x20был\x20заблокирован\x20из-за:\x20','catch','<br>','writer','appendChild','85722MCCJOg','closest','7032KiqoUN','API\x20response\x20structure\x20unexpected:','burger-button','statusText','.copy-button','chat-title','lastRequestDate','focus','trim','.dropdown-item','open','5JhlRlB','split','xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx','Неизвестная\x20роль','application/json','14vNsUaZ','roleId','category','remove','unshift'];_0x4eeb=function(){return _0x1a19fb;};return _0x4eeb();}function loadState(){const _0x2a24c7=_0x1d0733,_0x4d6d3e=localStorage['getItem'](_0x2a24c7(0x15e));if(_0x4d6d3e){const _0x145692=JSON[_0x2a24c7(0xfb)](_0x4d6d3e);dialogues=_0x145692['dialogues']||[],totalRequests=_0x145692[_0x2a24c7(0x103)]||0x0,todayRequests=_0x145692['todayRequests']||0x0,lastRequestDate=_0x145692[_0x2a24c7(0x128)]||null,currentRoleId=_0x145692['currentRoleId']||ROLES[0x0]['id'];const _0x2f081c=new Date()[_0x2a24c7(0x105)]()[_0x2a24c7(0x12e)]('T')[0x0];lastRequestDate!==_0x2f081c&&(todayRequests=0x0,lastRequestDate=_0x2f081c);const _0x4a38ca=dialogues['find'](_0x2171d5=>_0x2171d5['id']===_0x145692[_0x2a24c7(0x18a)]);dialogues[_0x2a24c7(0x145)]===0x0||!_0x4a38ca?createNewChat(!![]):currentDialogueId=_0x145692[_0x2a24c7(0x18a)];}else createNewChat(!![]);if(!currentDialogueId||!dialogues[_0x2a24c7(0x102)](_0x1900d5=>_0x1900d5['id']===currentDialogueId)){if(dialogues[_0x2a24c7(0x145)]>0x0)currentDialogueId=dialogues[0x0]['id'];else{createNewChat(!![]);return;}}saveState();}function _0x38d8(_0xd85e5e,_0x2920b3){const _0x4eebe2=_0x4eeb();return _0x38d8=function(_0x38d895,_0x260668){_0x38d895=_0x38d895-0xf7;let _0x5e5cdb=_0x4eebe2[_0x38d895];return _0x5e5cdb;},_0x38d8(_0xd85e5e,_0x2920b3);}function escapeHTML(_0x278acb){const _0x27d627=_0x1d0733;return _0x278acb[_0x27d627(0x179)](/&/g,_0x27d627(0x151))[_0x27d627(0x179)](/</g,_0x27d627(0xfa))['replace'](/>/g,'&gt;')[_0x27d627(0x179)](/"/g,_0x27d627(0x116))[_0x27d627(0x179)](/'/g,'&#039;');}function formatMessageContent(_0x16eede){const _0x4f47e7=_0x1d0733,_0x37f50a=/```(\w*)\n([\s\S]*?)```/g,_0xfa341d=/\*\*(.*?)\*\*/g;let _0x2ae7b5='',_0x1680e7=0x0;_0x16eede[_0x4f47e7(0x179)](_0x37f50a,(_0x24a357,_0x5ab265,_0x4b5c38,_0x3d98f1)=>{const _0x434336=_0x4f47e7;let _0x455a5c=_0x16eede['substring'](_0x1680e7,_0x3d98f1);_0x455a5c=escapeHTML(_0x455a5c),_0x455a5c=_0x455a5c[_0x434336(0x179)](_0xfa341d,'<span\x20class=\x22bold-text\x22>$1</span>'),_0x455a5c=_0x455a5c[_0x434336(0x179)](/\n/g,_0x434336(0x11d)),_0x2ae7b5+=_0x455a5c;const _0x336b7b=_0x5ab265||'code',_0x294dfb=_0x4b5c38[_0x434336(0x12a)]();return _0x2ae7b5+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22code-block\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22code-block-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22code-language\x22>'+escapeHTML(_0x336b7b)+_0x434336(0x112)+escapeHTML(_0x294dfb)+_0x434336(0x109),_0x1680e7=_0x3d98f1+_0x24a357[_0x434336(0x145)],_0x24a357;});let _0x14c678=_0x16eede[_0x4f47e7(0x104)](_0x1680e7);return _0x14c678=escapeHTML(_0x14c678),_0x14c678=_0x14c678[_0x4f47e7(0x179)](_0xfa341d,_0x4f47e7(0x171)),_0x14c678=_0x14c678[_0x4f47e7(0x179)](/\n/g,_0x4f47e7(0x11d)),_0x2ae7b5+=_0x14c678,_0x2ae7b5;}function addMessageToChat(_0x508898,_0x1e141a,_0x499dfa=![]){const _0x47af56=_0x1d0733,_0x25ff0e=document[_0x47af56(0x15f)](_0x47af56(0x15d));_0x25ff0e[_0x47af56(0x190)][_0x47af56(0x119)](_0x47af56(0x17b)),_0x25ff0e[_0x47af56(0x190)]['add'](_0x1e141a==='user'?'user-message':_0x47af56(0x10a));_0x499dfa&&_0x25ff0e[_0x47af56(0x190)]['add'](_0x47af56(0x167));const _0x96a178=document[_0x47af56(0x15f)](_0x47af56(0x15d));_0x96a178[_0x47af56(0x190)][_0x47af56(0x119)](_0x47af56(0x180)),_0x96a178[_0x47af56(0x18f)]=_0x1e141a===_0x47af56(0x18e)?'Вы':'AI';const _0x1ce046=document['createElement'](_0x47af56(0x15d));_0x1ce046[_0x47af56(0x190)][_0x47af56(0x119)]('message-content');_0x499dfa?_0x1ce046[_0x47af56(0x149)]=_0x508898:_0x1e141a==='ai'?_0x1ce046[_0x47af56(0x149)]=formatMessageContent(_0x508898):(_0x1ce046[_0x47af56(0x18f)]=_0x508898,_0x1ce046['innerHTML']=_0x1ce046[_0x47af56(0x149)][_0x47af56(0x179)](/\n/g,'<br>'));_0x25ff0e['appendChild'](_0x96a178),_0x25ff0e[_0x47af56(0x11f)](_0x1ce046),chatMessagesContainer['appendChild'](_0x25ff0e),chatMessagesContainer[_0x47af56(0x143)]=chatMessagesContainer['scrollHeight'];if(_0x499dfa)return _0x25ff0e;}function removeMessageFromChatElement(_0x17a12b){const _0x300db6=_0x1d0733;_0x17a12b&&_0x17a12b[_0x300db6(0x185)]&&_0x17a12b[_0x300db6(0x185)][_0x300db6(0xfd)](_0x17a12b);}function renderMessages(_0x3a5f7b){const _0xcc544a=_0x1d0733;chatMessagesContainer[_0xcc544a(0x149)]='';const _0x6a56b4=dialogues[_0xcc544a(0x102)](_0x30b4ff=>_0x30b4ff['id']===_0x3a5f7b);if(!_0x6a56b4){addMessageToChat(_0xcc544a(0x139),'ai');return;}_0x6a56b4['messages'][_0xcc544a(0x145)]===0x0?addMessageToChat('Задавай\x20свои\x20вопросы\x20а\x20я\x20помогу\x20вам\x20на\x20них\x20ответить.','ai'):_0x6a56b4['messages']['forEach'](_0x35dba6=>{const _0x172ff1=_0xcc544a;addMessageToChat(_0x35dba6[_0x172ff1(0x166)],_0x35dba6['sender']);});}function renderChatList(){const _0x123035=_0x1d0733;chatList[_0x123035(0x149)]='';if(dialogues[_0x123035(0x145)]===0x0){const _0x475d05=document[_0x123035(0x15f)]('li');_0x475d05[_0x123035(0x190)][_0x123035(0x119)](_0x123035(0x194),_0x123035(0x162)),_0x475d05['textContent']='Нет\x20диалогов',chatList['appendChild'](_0x475d05);return;}dialogues[_0x123035(0x19f)](_0x51e3c5=>{const _0x1d2feb=_0x123035,_0x5c0677=document['createElement']('li');_0x5c0677[_0x1d2feb(0x190)][_0x1d2feb(0x119)]('chat-item');_0x51e3c5['id']===currentDialogueId&&_0x5c0677[_0x1d2feb(0x190)]['add']('active');_0x5c0677[_0x1d2feb(0x17e)][_0x1d2feb(0x198)]=_0x51e3c5['id'];const _0x55bac7=document['createElement'](_0x1d2feb(0x144));_0x55bac7[_0x1d2feb(0x190)][_0x1d2feb(0x119)](_0x1d2feb(0x127));const _0x228c77=_0x51e3c5['messages'][_0x1d2feb(0x102)](_0x37f0ef=>_0x37f0ef[_0x1d2feb(0x16e)]===_0x1d2feb(0x18e));_0x55bac7[_0x1d2feb(0x18f)]=_0x51e3c5[_0x1d2feb(0x17a)]||(_0x228c77?_0x228c77[_0x1d2feb(0x166)]['substring'](0x0,0x1e)+(_0x228c77['text'][_0x1d2feb(0x145)]>0x1e?_0x1d2feb(0x191):''):_0x1d2feb(0x152));const _0x40d903=document[_0x1d2feb(0x15f)]('div');_0x40d903[_0x1d2feb(0x190)]['add'](_0x1d2feb(0x13a));const _0x2477be=document['createElement']('i');_0x2477be[_0x1d2feb(0x190)][_0x1d2feb(0x119)](_0x1d2feb(0x113),_0x1d2feb(0x168)),_0x2477be[_0x1d2feb(0x17a)]=_0x1d2feb(0x160),_0x2477be[_0x1d2feb(0x17e)][_0x1d2feb(0x18b)]=_0x1d2feb(0x14e),_0x40d903[_0x1d2feb(0x11f)](_0x2477be),_0x5c0677[_0x1d2feb(0x11f)](_0x55bac7),_0x5c0677[_0x1d2feb(0x11f)](_0x40d903),chatList[_0x1d2feb(0x11f)](_0x5c0677);});}function renderRolesDropdown(){const _0x3184a5=_0x1d0733;roleSelectDropdown[_0x3184a5(0x149)]='',ROLES[_0x3184a5(0x19f)](_0x104f0e=>{const _0x237c5b=_0x3184a5,_0x216416=document[_0x237c5b(0x15f)]('div');_0x216416['classList'][_0x237c5b(0x119)](_0x237c5b(0x137)),_0x104f0e['id']===currentRoleId&&_0x216416['classList'][_0x237c5b(0x119)](_0x237c5b(0x16c)),_0x216416[_0x237c5b(0x17e)]['roleId']=_0x104f0e['id'],_0x216416['textContent']=_0x104f0e[_0x237c5b(0x154)],roleSelectDropdown[_0x237c5b(0x11f)](_0x216416);}),updateSelectedRoleName();}function updateSelectedRoleName(){const _0x108f6e=_0x1d0733,_0x39b1cb=ROLES[_0x108f6e(0x102)](_0x5e5a21=>_0x5e5a21['id']===currentRoleId);selectedRoleNameSpan[_0x108f6e(0x18f)]=_0x39b1cb?_0x39b1cb[_0x108f6e(0x154)]:_0x108f6e(0x130);}function switchRole(_0x1183b1){if(currentRoleId===_0x1183b1)return;currentRoleId=_0x1183b1,saveState(),renderRolesDropdown();}function updateCountersUI(){const _0xa996bb=_0x1d0733;totalRequestsSpan[_0xa996bb(0x18f)]=totalRequests,todayRequestsSpan['textContent']=todayRequests;}function createNewChat(_0x5abc5f=!![]){const _0x290461=_0x1d0733,_0x48646d=generateUUID(),_0xd99fd6={'id':_0x48646d,'title':'','messages':[]};dialogues[_0x290461(0x136)](_0xd99fd6),_0x5abc5f&&(currentDialogueId=_0x48646d,saveState(),renderChatList(),renderMessages(currentDialogueId));}function switchChat(_0x3f4444){const _0x20df8d=_0x1d0733;if(currentDialogueId===_0x3f4444)return;currentDialogueId=_0x3f4444,saveState(),renderChatList(),renderMessages(currentDialogueId),sidebar[_0x20df8d(0x190)][_0x20df8d(0x135)](_0x20df8d(0x12c)),overlay[_0x20df8d(0x190)][_0x20df8d(0x135)]('open');}function deleteChat(_0x40d495){const _0x19ba44=_0x1d0733,_0x109506=dialogues['findIndex'](_0x2e3f5f=>_0x2e3f5f['id']===_0x40d495);if(_0x109506===-0x1)return;dialogues[_0x19ba44(0x15b)](_0x109506,0x1);if(dialogues[_0x19ba44(0x145)]===0x0)createNewChat(!![]);else currentDialogueId===_0x40d495?(currentDialogueId=dialogues[0x0]['id'],saveState(),renderChatList(),renderMessages(currentDialogueId)):(saveState(),renderChatList());}function clearAllChats(){const _0x3881f4=_0x1d0733;confirm(_0x3881f4(0x110))&&(dialogues=[],createNewChat(!![]),updateCountersUI(),saveState());}async function sendMessage(){const _0x1df16f=_0x1d0733,_0x57c921=messageInput[_0x1df16f(0x164)][_0x1df16f(0x12a)]();if(!_0x57c921)return;const _0x53809f=dialogues[_0x1df16f(0x102)](_0x25fdf4=>_0x25fdf4['id']===currentDialogueId);if(!_0x53809f){addMessageToChat('Ошибка:\x20Текущий\x20диалог\x20не\x20найден.','ai'),saveState();return;}addMessageToChat(_0x57c921,_0x1df16f(0x18e)),_0x53809f[_0x1df16f(0x153)][_0x1df16f(0x118)]({'text':_0x57c921,'sender':_0x1df16f(0x18e)}),messageInput[_0x1df16f(0x164)]='',messageInput['disabled']=!![],sendButton[_0x1df16f(0x177)]=!![];const _0x448a0b=addMessageToChat(_0x1df16f(0x117),'ai',!![]);try{const _0x492cdf=ROLES[_0x1df16f(0x102)](_0x292f53=>_0x292f53['id']===currentRoleId),_0x403f0f=_0x492cdf?_0x492cdf[_0x1df16f(0x106)]:'',_0x6071f={'contents':_0x53809f['messages'][_0x1df16f(0x111)](_0x9e3c5c=>({'role':_0x9e3c5c[_0x1df16f(0x16e)]===_0x1df16f(0x18e)?'user':_0x1df16f(0x169),'parts':[{'text':_0x9e3c5c[_0x1df16f(0x166)]}]}))};_0x403f0f&&(_0x6071f[_0x1df16f(0x186)]={'parts':[{'text':_0x403f0f}]});const _0x5d957e=await fetch(API_ENDPOINT,{'method':_0x1df16f(0x196),'headers':{'Content-Type':_0x1df16f(0x131)},'body':JSON[_0x1df16f(0x181)](_0x6071f)});removeMessageFromChatElement(_0x448a0b);if(!_0x5d957e['ok']){const _0x56356b=await _0x5d957e['json']();console[_0x1df16f(0x13e)](_0x1df16f(0x101),_0x5d957e[_0x1df16f(0x158)],_0x5d957e[_0x1df16f(0x125)],_0x56356b);let _0x5d85e9='HTTP\x20Ошибка\x20API:\x20'+_0x5d957e[_0x1df16f(0x158)]+'\x20'+_0x5d957e[_0x1df16f(0x125)]+'.';_0x56356b&&_0x56356b[_0x1df16f(0x13e)]&&_0x56356b[_0x1df16f(0x13e)][_0x1df16f(0x17b)]&&(_0x5d85e9+=_0x1df16f(0x13c)+_0x56356b[_0x1df16f(0x13e)][_0x1df16f(0x17b)]),addMessageToChat(_0x5d85e9,'ai');}else{const _0x36bf27=await _0x5d957e[_0x1df16f(0x10c)]();console['log'](_0x1df16f(0x17f),_0x36bf27);let _0x1e8a9b=_0x1df16f(0xfc);if(_0x36bf27[_0x1df16f(0x19a)]&&_0x36bf27[_0x1df16f(0x19a)][_0x1df16f(0x145)]>0x0&&_0x36bf27[_0x1df16f(0x19a)][0x0]['content']&&_0x36bf27[_0x1df16f(0x19a)][0x0]['content'][_0x1df16f(0x148)]&&_0x36bf27[_0x1df16f(0x19a)][0x0][_0x1df16f(0x16b)][_0x1df16f(0x148)][_0x1df16f(0x145)]>0x0&&_0x36bf27[_0x1df16f(0x19a)][0x0][_0x1df16f(0x16b)][_0x1df16f(0x148)][0x0][_0x1df16f(0x166)]){_0x1e8a9b=_0x36bf27['candidates'][0x0][_0x1df16f(0x16b)][_0x1df16f(0x148)][0x0][_0x1df16f(0x166)],addMessageToChat(_0x1e8a9b,'ai'),_0x53809f[_0x1df16f(0x153)][_0x1df16f(0x118)]({'text':_0x1e8a9b,'sender':'ai'});!_0x53809f[_0x1df16f(0x17a)]&&_0x53809f[_0x1df16f(0x153)][_0x1df16f(0x145)]>0x0&&_0x53809f[_0x1df16f(0x153)][0x0][_0x1df16f(0x16e)]===_0x1df16f(0x18e)&&(_0x53809f[_0x1df16f(0x17a)]=_0x53809f[_0x1df16f(0x153)][0x0][_0x1df16f(0x166)][_0x1df16f(0x104)](0x0,0x1e)+(_0x53809f[_0x1df16f(0x153)][0x0][_0x1df16f(0x166)]['length']>0x1e?_0x1df16f(0x191):''),renderChatList());totalRequests++;const _0x40634d=new Date()['toISOString']()[_0x1df16f(0x12e)]('T')[0x0];lastRequestDate!==_0x40634d?(todayRequests=0x1,lastRequestDate=_0x40634d):todayRequests++,updateCountersUI();}else{if(_0x36bf27[_0x1df16f(0x150)]&&_0x36bf27[_0x1df16f(0x150)]['blockReason']){let _0x5090af=_0x36bf27['promptFeedback'][_0x1df16f(0x115)],_0x1cd8e0=_0x36bf27[_0x1df16f(0x150)][_0x1df16f(0x13d)],_0x487aa3=_0x1df16f(0x11b)+_0x5090af+'.';_0x1cd8e0&&_0x1cd8e0[_0x1df16f(0x145)]>0x0&&(_0x487aa3+='\x20Причины:\x20'+_0x1cd8e0['map'](_0x180040=>_0x180040[_0x1df16f(0x134)]+'\x20('+_0x180040[_0x1df16f(0x172)]+')')[_0x1df16f(0xff)](',\x20')),addMessageToChat(_0x487aa3,'ai');}else{console[_0x1df16f(0x13e)](_0x1df16f(0x123),_0x36bf27);let _0x7fb39b=_0x1df16f(0x199);addMessageToChat(_0x7fb39b,'ai');}}}saveState();}catch(_0x1680c5){console[_0x1df16f(0x13e)]('Произошла\x20ошибка\x20при\x20отправке\x20сообщения\x20или\x20обработке\x20ответа:',_0x1680c5),removeMessageFromChatElement(_0x448a0b);const _0x48d091=_0x1df16f(0x100)+(_0x1680c5['message']||_0x1df16f(0x155))+'.\x20Проверьте\x20консоль\x20браузера\x20(F12).';addMessageToChat(_0x48d091,'ai'),saveState();}finally{messageInput['disabled']=![],sendButton['disabled']=![],messageInput[_0x1df16f(0x129)](),renderChatList();}}sendButton[_0x1d0733(0x19d)](_0x1d0733(0x13b),sendMessage),messageInput[_0x1d0733(0x19d)](_0x1d0733(0x175),function(_0x211d4e){const _0x1a02d6=_0x1d0733;_0x211d4e[_0x1a02d6(0x197)]===_0x1a02d6(0x141)&&!_0x211d4e[_0x1a02d6(0x140)]&&(_0x211d4e[_0x1a02d6(0x174)](),sendMessage());}),newChatButton[_0x1d0733(0x19d)](_0x1d0733(0x13b),()=>{const _0x561e29=_0x1d0733;createNewChat(!![]),sidebar[_0x561e29(0x190)][_0x561e29(0x135)](_0x561e29(0x12c)),overlay['classList'][_0x561e29(0x135)]('open');}),clearChatsButton['addEventListener'](_0x1d0733(0x13b),()=>{const _0x318356=_0x1d0733;clearAllChats(),sidebar['classList'][_0x318356(0x135)](_0x318356(0x12c)),overlay[_0x318356(0x190)][_0x318356(0x135)](_0x318356(0x12c));}),chatList[_0x1d0733(0x19d)](_0x1d0733(0x13b),_0x50c1f0=>{const _0x1a026d=_0x1d0733,_0x32429c=_0x50c1f0[_0x1a026d(0x187)]['closest']('.chat-item');if(!_0x32429c||!_0x32429c[_0x1a026d(0x17e)][_0x1a026d(0x198)])return;const _0x148e1f=_0x32429c[_0x1a026d(0x17e)][_0x1a026d(0x198)],_0x104f40=_0x50c1f0[_0x1a026d(0x187)];_0x104f40['classList'][_0x1a026d(0x183)](_0x1a026d(0x168))?confirm(_0x1a026d(0x19b))&&deleteChat(_0x148e1f):switchChat(_0x148e1f);}),roleSelect[_0x1d0733(0x19d)](_0x1d0733(0x13b),_0x12cc27=>{const _0xa19609=_0x1d0733;_0x12cc27[_0xa19609(0x159)](),roleSelectDropdown['style'][_0xa19609(0xf8)]=roleSelectDropdown[_0xa19609(0x108)][_0xa19609(0xf8)]===_0xa19609(0x15a)?_0xa19609(0x17c):_0xa19609(0x15a);}),roleSelectDropdown[_0x1d0733(0x19d)](_0x1d0733(0x13b),_0x3631b4=>{const _0x2ab278=_0x1d0733,_0x21911c=_0x3631b4[_0x2ab278(0x187)][_0x2ab278(0x121)](_0x2ab278(0x12b));_0x21911c&&_0x21911c[_0x2ab278(0x17e)][_0x2ab278(0x133)]&&(switchRole(_0x21911c[_0x2ab278(0x17e)][_0x2ab278(0x133)]),roleSelectDropdown[_0x2ab278(0x108)][_0x2ab278(0xf8)]=_0x2ab278(0x17c));}),document[_0x1d0733(0x19d)](_0x1d0733(0x13b),_0x3a58c1=>{const _0x225876=_0x1d0733;!roleSelect[_0x225876(0x183)](_0x3a58c1['target'])&&(roleSelectDropdown[_0x225876(0x108)][_0x225876(0xf8)]='none');}),chatMessagesContainer[_0x1d0733(0x19d)]('click',_0x5f4dc0=>{const _0x33e3fd=_0x1d0733;if(_0x5f4dc0[_0x33e3fd(0x187)][_0x33e3fd(0x190)][_0x33e3fd(0x183)](_0x33e3fd(0x176))||_0x5f4dc0[_0x33e3fd(0x187)][_0x33e3fd(0x121)]('.copy-button')){const _0xbae722=_0x5f4dc0['target'][_0x33e3fd(0x121)](_0x33e3fd(0x126)),_0x316c35=_0xbae722[_0x33e3fd(0x121)]('.code-block');if(_0x316c35){const _0x428e7b=_0x316c35['querySelector'](_0x33e3fd(0x10f));_0x428e7b&&navigator[_0x33e3fd(0x193)][_0x33e3fd(0x16f)](_0x428e7b[_0x33e3fd(0x18f)])[_0x33e3fd(0x147)](()=>{const _0x547753=_0x33e3fd,_0x1683b9=_0xbae722[_0x547753(0x149)];_0xbae722['innerHTML']=_0x547753(0x19e),_0xbae722[_0x547753(0x190)][_0x547753(0x119)](_0x547753(0x17d)),setTimeout(()=>{const _0x192394=_0x547753;_0xbae722['innerHTML']=_0x1683b9,_0xbae722[_0x192394(0x190)][_0x192394(0x135)](_0x192394(0x17d));},0x7d0);})[_0x33e3fd(0x11c)](_0x2a8b54=>{const _0x464133=_0x33e3fd;console[_0x464133(0x13e)](_0x464133(0x161),_0x2a8b54);});}}}),document['addEventListener'](_0x1d0733(0x114),()=>{const _0x598305=_0x1d0733;loadState(),renderChatList(),currentDialogueId?renderMessages(currentDialogueId):dialogues['length']>0x0?switchChat(dialogues[0x0]['id']):createNewChat(!![]),renderRolesDropdown(),updateCountersUI(),burgerButton['addEventListener'](_0x598305(0x13b),()=>{const _0x1d0d07=_0x598305;sidebar[_0x1d0d07(0x190)][_0x1d0d07(0x10d)]('open'),overlay['classList'][_0x1d0d07(0x10d)](_0x1d0d07(0x12c));}),mobileBurgerButton['addEventListener']('click',()=>{const _0x1e1d03=_0x598305;sidebar[_0x1e1d03(0x190)][_0x1e1d03(0x10d)]('open'),overlay[_0x1e1d03(0x190)][_0x1e1d03(0x10d)]('open');}),overlay[_0x598305(0x19d)]('click',()=>{const _0x11fb17=_0x598305;sidebar[_0x11fb17(0x190)][_0x11fb17(0x135)]('open'),overlay[_0x11fb17(0x190)][_0x11fb17(0x135)](_0x11fb17(0x12c));});});
